{% extends 'easy/base.html' %}

<link rel="stylesheet" href="http://code.jquery.com/ui/1.8.18/themes/base/jquery-ui.css" type="text/css" media="all" /> 
{% block content %}
<div class="container">
    <div class="row">

<form id="search" method="POST" action="{% url 'easy:guest_search' %}">
 {% csrf_token %}
 <input type="text" class="form-control" id="txtSearch" name="txtSearch">
 <button type="submit" class="btn btn-default btn-submit">Submit</button>
</form>

{% if room %}
    <ul>

    {% include "easy/message.html" %}
    {{ room.room_number }} <br>
    {{ room.room_type }} <br>
    {{ room.number_of_beds }} <br>
    {{ room.is_smoke }} <br>
    {{ room.is_balcony }} <br>
    {{ room.created_at }} <br>
    {{ room.updated_at }} <br>
    </ul>
{% else %}
    <p>No room could be found.</p>
{% endif %}
    </div>
</div>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"> </script> 
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js" type="text/javascript"></script>

  <script>
    $("#txtSearch").change(function () {
      var username = $(this).val();

      $.ajax({
        url: '{% url "easy:guest_search" %}',
        data: {
          'guest_name': username
        },
        dataType: 'json',
        success: function (data) {
          if (data.is_taken) {
            alert("A user with this username already exists.");
          }
        }
      });

    });
  </script>

{% endblock %}
